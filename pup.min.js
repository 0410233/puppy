(function(e,t){if(document.addEventListener){e.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,o){o=o||e;for(var r=0;r<this.length;r++)t.call(o,this[r],r,this)});var o=t();null!=o&&(e.pup=o,e.onunload=function(){o.sleep(),e.pup=null},document.addEventListener("DOMContentLoaded",function(){o.wakeup();var e=document.querySelectorAll(o.selector);e.length&&e.forEach(function(e){var t=e.querySelector('input[name="track_report"]');t||(t=document.createElement("input"),t.setAttribute("name","track_report"),t.setAttribute("type","text"),t.setAttribute("style","display:none"),e.appendChild(t)),e.addEventListener("submit",function(){t.value=o.notes()})})}))}})(window,function(){function e(e){return"/"===e.slice(-1)&&(e+="index.html"),e.toLowerCase()}function t(){s=n.PUPsNoteBook;try{if(!s)throw"notebook is not available";if(s=JSON.parse(s),!s||s.version!==l)throw"notebook is not available or version does not match";var e=s.memory.length,t=s.memory[e-1];if(u-t.leave>5e3)throw">=5s";if(t.url===a.url)s.memory.push(c);else{if(t.url!==c.url)throw"other";c=t,c.leave=u}}catch(e){s={version:l,memory:[a,c]}}}function o(){c.leave=Date.now(),n.PUPsNoteBook=JSON.stringify(s)}function r(){clearTimeout(f),o(),f=setTimeout(r,3e3)}var n=window.localStorage;if("object"!=typeof n)return null;var i=window.location,l="0.2.3",u=Date.now(),a={url:e(document.referrer),enter:u,leave:u},c={url:e(i.href),enter:u,leave:u},s=null,f=null;return{selector:"form.report_trace",home:function(e){this.selector=e},wakeup:function(){t(),r()},sleep:function(){clearTimeout(f),o()},notes:function(){o();for(var e={refer:s.memory[0].url,trace:[]},t=null,r=s.memory.length-1;r>0;r--)t=s.memory[r],e.trace.push([t.url,Math.round((t.leave-t.enter)/1e3)]);return JSON.stringify(e)}}});