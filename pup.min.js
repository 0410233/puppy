(function(e,t){if(e.addEventListener){var o=t();null!=o&&(e.pup=o,e.onunload=function(){o.sleep(),e.pup=null},document.addEventListener("DOMContentLoaded",function(){o.wakeup();var e,t,n,r,l=document.querySelectorAll(o.selector);if(l.length)for(n=0,r=l.length;n<r;n++)e=l.item(n),t=e.querySelector('input[name="track_report"]'),t||(t=document.createElement("input"),t.setAttribute("name","track_report"),t.setAttribute("type","text"),t.setAttribute("style","display:none"),e.appendChild(t)),e.onsubmit=function(){t.value=o.notes()}}))}})(window,function(){function e(e){return"/"===e.slice(-1)&&(e+="index.html"),e.toLowerCase()}function t(){s=r.PUPsNoteBook;try{if(!s)throw"notebook is not available";if(s=JSON.parse(s),!s||s.version!==u)throw"notebook is not available or version does not match";var e=s.memory.length,t=s.memory[e-1];if(i-t.leave>5e3)throw">=5s";if(t.url===a.url)s.memory.push(c);else{if(t.url!==c.url)throw"other";c=t,c.leave=i}}catch(e){s={version:u,memory:[a,c]}}}function o(){c.leave=Date.now(),r.PUPsNoteBook=JSON.stringify(s)}function n(){clearTimeout(f),o(),f=setTimeout(n,3e3)}var r=window.localStorage;if("object"!=typeof r)return null;var l=window.location,u="0.2.2",i=Date.now(),a={url:e(document.referrer),enter:i,leave:i},c={url:e(l.href),enter:i,leave:i},s=null,f=null;return{selector:"form.report_trace",home:function(e){this.selector=e},wakeup:function(){t(),n()},sleep:function(){clearTimeout(f),o()},notes:function(){o();for(var e={refer:s.memory[0].url,trace:[]},t=null,n=s.memory.length-1;n>0;n--)t=s.memory[n],e.trace.push([t.url,Math.round((t.leave-t.enter)/1e3)]);return JSON.stringify(e)}}});