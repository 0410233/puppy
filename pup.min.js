(function(e,t){if(e.addEventListener){var r=t();null!=r&&(e.pup=r,e.addEventListener("unload",function(){r.sleep(),e.pup=null}),e.addEventListener("DOMContentLoaded",function(){r.wakeup();var e=document.querySelectorAll(r.selector);e.length&&e.forEach(function(e){var t=e.querySelector('input[name="track_report"]');t||(t=document.createElement("input"),t.setAttribute("name","track_report"),t.setAttribute("type","text"),t.setAttribute("style","display:none"),e.appendChild(t)),e.onsubmit=function(){t.value=r.report()}})}))}})(window,function(){function e(e){return"/"===e.slice(-1)&&(e+="index.html"),e.toLowerCase()}function t(){p=o.PUP;try{if(!p)throw"";if(p=JSON.parse(p),p.version!==l)throw"";var e=p.memory.length,t=p.memory[e-1];if(t.url===c.url){if(!(i-t.leave<5e3))throw"";c=t,c.leave=i}else{if(!(t.url===a.url&&i-t.leave<5e3))throw"";p.memory.push(c)}}catch(e){p={version:l,memory:[a,c]}}}function r(){c.leave=Date.now(),o.PUP=JSON.stringify(pup)}function n(){clearTimeout(f),r(),f=setTimeout(n,3e3)}var o=window.localStorage;if("object"!=typeof o)return null;var u=window.location,l="0.1.0",i=Date.now(),a={url:e(document.referrer),enter:i,leave:i},c={url:e(u.href),enter:i,leave:i},p=null,f=null;return{selector:"form.report_trace",home:function(e){this.selector=e},wakeup:function(){t(),n()},sleep:function(){clearTimeout(f),r()},report:function(){r();for(var e={refer:pup.memory[0].url,trace:[]},t=null,n=pup.memory.length-1;n>0;n--)t=pup.memory[n],e.trace.push([t.url,Math.round((t.leave-t.enter)/1e3)]);return JSON.stringify(e)}}});